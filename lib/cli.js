// Generated by CoffeeScript 1.7.1
(function() {
  var cfFedWiki, cli, help, nopt, path, utils, _;

  path = require("path");

  _ = require("underscore");

  nopt = require("nopt");

  cfFedWiki = require("./cf-fed-wiki");

  utils = require("./utils");

  cli = exports;

  cli.main = function(args) {
    var defValue, defValues, longOpts, name, opt, opts, parsed, shortName, shortOpts, type, _ref;
    if (args.length === 0) {
      help();
    }
    if ((_ref = args[0]) === "?" || _ref === "-?" || _ref === "--?") {
      help();
    }
    opts = {
      home: ["h", String],
      id: ["i", String],
      verbose: ["v", Boolean],
      help: ["h", Boolean]
    };
    longOpts = {};
    shortOpts = {};
    defValues = {};
    for (name in opts) {
      opt = opts[name];
      shortName = opt[0], type = opt[1], defValue = opt[2];
      if (type === Boolean) {
        defValue = false;
      }
      shortOpts[shortName] = "--" + name;
      longOpts[name] = type;
      if (defValue != null) {
        defValues[name] = defValue;
      }
    }
    parsed = nopt(longOpts, shortOpts, args, 0);
    if (parsed.help) {
      help();
    }
    args = parsed.argv.remain;
    opts = _.pick(parsed, _.keys(longOpts));
    opts = _.defaults(opts, defValues);
    utils.verbose(opts.verbose);
    return cfFedWiki.run(args, opts);
  };

  help = function() {
    console.log("usage:\n\n    cf-fed-wiki [options]\n\noptions:\n\n    -v --verbose        generate diagnostic messages\n\n\nversion: " + utils.VERSION + "; for more info: " + utils.HOMEPAGE);
    return process.exit(1);
  };

  if (require.main === module) {
    cli.main.call(null, process.argv.slice(2));
  }

}).call(this);
